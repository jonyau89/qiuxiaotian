---
import { SITE_TITLE, BASE_URL } from '../consts';
---

<header class="navbar" id="navbar">
	<div class="navbar-container">
		<a href={`${BASE_URL}/`} class="navbar-brand">{SITE_TITLE}</a>
		
		<!-- 移动端菜单按钮 -->
		<button class="mobile-menu-button" id="mobile-menu-button">
			<i class="fas fa-bars"></i>
		</button>
		
		<!-- 导航菜单 -->
		<div class="navbar-menu" id="navbar-menu">
			<a href={`${BASE_URL}/`} class="navbar-link active">首页</a>
				<a href={`${BASE_URL}/blog`} class="navbar-link">文章</a>
				<a href={`${BASE_URL}/tools`} class="navbar-link">下载工具</a>
				
				<!-- 深色/浅色模式切换 -->
				<button class="theme-toggle" id="theme-toggle" aria-label="切换主题">
					<i class="fas fa-moon"></i>
				</button>
				
				<!-- 搜索表单 -->
				<div class="navbar-search">
					<form action="#" method="GET">
						<input type="text" placeholder="搜索文章或工具...">
						<button type="submit"><i class="fas fa-search"></i></button>
					</form>
				</div>
		</div>
	</div>
</header>

<script>
	// 移动端菜单切换
	const mobileMenuButton = document.getElementById('mobile-menu-button');
	const navbarMenu = document.getElementById('navbar-menu');
	
	if (mobileMenuButton && navbarMenu) {
		mobileMenuButton.addEventListener('click', () => {
			navbarMenu.classList.toggle('active');
			const icon = mobileMenuButton.querySelector('i');
			if (navbarMenu.classList.contains('active')) {
				icon.classList.remove('fa-bars');
				icon.classList.add('fa-times');
			} else {
				icon.classList.remove('fa-times');
				icon.classList.add('fa-bars');
			}
		});
	}
	
	// 滚动效果
	const navbar = document.getElementById('navbar');
	if (navbar) {
		window.addEventListener('scroll', () => {
			if (window.scrollY > 50) {
				navbar.classList.add('scrolled');
			} else {
				navbar.classList.remove('scrolled');
			}
		});
	}
	
	// 导航链接高亮
	const navbarLinks = document.querySelectorAll('.navbar-link');
	const currentPath = window.location.pathname;
	
	navbarLinks.forEach(link => {
		const linkPath = link.getAttribute('href');
		if (currentPath === linkPath || (linkPath === '/blog' && currentPath.includes('/blog')) || (linkPath === '/tools' && currentPath.includes('/tools'))) {
			link.classList.add('active');
		} else {
			link.classList.remove('active');
		}
	});
	
	// 主题切换功能
	const themeToggle = document.getElementById('theme-toggle');
	const html = document.documentElement;
	
	// 检查本地存储中的主题设置
	const savedTheme = localStorage.getItem('theme');
	if (savedTheme) {
		html.setAttribute('data-theme', savedTheme);
		updateThemeIcon(savedTheme);
	} else {
		// 默认使用系统主题
		const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
		html.setAttribute('data-theme', systemTheme);
		updateThemeIcon(systemTheme);
	}
	
	// 主题切换按钮点击事件
	if (themeToggle) {
		themeToggle.addEventListener('click', () => {
			const currentTheme = html.getAttribute('data-theme');
			const newTheme = currentTheme === 'light' ? 'dark' : 'light';
			html.setAttribute('data-theme', newTheme);
			localStorage.setItem('theme', newTheme);
			updateThemeIcon(newTheme);
		});
	}
	
	// 更新主题图标
	function updateThemeIcon(theme) {
		if (!themeToggle) return;
		const icon = themeToggle.querySelector('i');
		if (icon) {
			icon.className = theme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
		}
	}
</script>
